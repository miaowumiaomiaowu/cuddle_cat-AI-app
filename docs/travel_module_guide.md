# 旅行记录模块使用指南

## 🎯 模块概述

旅行记录模块是暖猫应用的核心功能之一，专为中国大陆用户设计，提供完整的旅行记录和管理功能。

## ✨ 主要功能

### 1. 📍 智能定位服务
- **高德地图集成**: 使用高德地图API，适配中国大陆网络环境
- **精准定位**: GPS + 网络定位，提供高精度位置信息
- **地址解析**: 自动获取详细地址信息（省份、城市、具体地址）
- **POI搜索**: 搜索周边兴趣点，丰富旅行记录

### 2. 📝 丰富记录功能
- **多媒体支持**: 照片、视频、音频、文字综合记录
- **情绪标记**: 为每个地点标记当时的心情和感受
- **标签系统**: 自定义标签，方便分类和搜索
- **同行者记录**: 记录旅行同伴信息
- **评分系统**: 1-5星评分系统
- **隐私控制**: 设置记录的可见性

### 3. 🔍 强大搜索筛选
- **关键词搜索**: 支持标题、描述、地址、标签搜索
- **多维度筛选**: 按城市、省份、心情、标签、日期范围筛选
- **实时筛选**: 筛选条件实时生效，无需等待

### 4. 📊 详细统计分析
- **旅行统计**: 总记录数、去过的城市数、总里程等
- **心情分布**: 分析旅行中的情绪变化
- **时间分析**: 月度旅行频率统计
- **热门地点**: 最常去的城市和景点
- **标签统计**: 最常用的标签分析

## 🏗️ 技术架构

### 核心组件
```
TravelRecord (数据模型)
├── LocationInfo (位置信息)
├── MediaItem (媒体文件)
├── WeatherInfo (天气信息)
└── TravelStats (统计数据)

TravelService (数据服务)
├── 本地存储管理
├── 媒体文件处理
├── 统计数据计算
└── 数据同步

AmapService (地图服务)
├── 定位服务
├── 地理编码
├── POI搜索
└── 距离计算

TravelProvider (状态管理)
├── 数据状态管理
├── 筛选逻辑
├── 错误处理
└── 加载状态
```

### 数据存储
- **本地存储**: SharedPreferences + 文件系统
- **媒体文件**: 应用私有目录存储
- **数据格式**: JSON序列化
- **备份机制**: 支持数据导出和恢复

## 🚀 使用方法

### 1. 测试模块功能
1. 启动应用
2. 进入"个人中心"页面
3. 点击"旅行测试"按钮
4. 进入旅行记录测试页面

### 2. 基本操作
- **添加记录**: 点击右下角"+"按钮
- **查看统计**: 页面顶部显示统计信息
- **测试定位**: 点击"获取位置"按钮
- **添加照片**: 点击"添加照片"按钮
- **删除记录**: 点击记录卡片右侧菜单

### 3. 高级功能
- **搜索记录**: 使用搜索框输入关键词
- **筛选记录**: 使用各种筛选条件
- **查看详情**: 点击记录卡片查看详细信息
- **编辑记录**: 长按记录卡片进入编辑模式

## ⚙️ 配置说明

### 高德地图API配置
在使用前需要配置高德地图API密钥：

1. 访问[高德开放平台](https://lbs.amap.com/)
2. 注册账号并创建应用
3. 获取API密钥
4. 在`lib/services/amap_service.dart`中配置：

```dart
// 替换为实际的API Key
static const String _webApiKey = 'YOUR_AMAP_WEB_API_KEY';
static const String _iosApiKey = 'YOUR_AMAP_IOS_API_KEY';
static const String _androidApiKey = 'YOUR_AMAP_ANDROID_API_KEY';
```

### 权限配置
应用需要以下权限：
- **位置权限**: 获取GPS定位
- **存储权限**: 保存媒体文件
- **相机权限**: 拍照功能
- **网络权限**: 地图服务和数据同步

## 🐛 常见问题

### Q: 定位失败怎么办？
A: 
1. 检查是否授予了位置权限
2. 确保网络连接正常
3. 检查高德地图API密钥是否正确配置
4. 在室外环境下测试GPS定位

### Q: 照片添加失败？
A:
1. 检查存储权限是否授予
2. 确保设备有足够的存储空间
3. 检查相机权限是否授予

### Q: 数据丢失怎么办？
A:
1. 数据存储在本地，卸载应用会丢失数据
2. 建议定期使用数据备份功能
3. 未来版本将支持云端同步

### Q: 地图服务不可用？
A:
1. 确保在中国大陆网络环境下使用
2. 检查高德地图API配额是否用完
3. 确认API密钥配置正确

## 🔮 未来规划

### 短期目标 (1-2个月)
- [ ] 完善UI界面设计
- [ ] 添加更多媒体类型支持
- [ ] 优化性能和用户体验
- [ ] 添加数据导出功能

### 中期目标 (3-6个月)
- [ ] 集成云端存储服务
- [ ] 添加社交分享功能
- [ ] 支持离线地图
- [ ] 添加路线规划功能

### 长期目标 (6个月以上)
- [ ] AI智能推荐旅行路线
- [ ] 与其他用户分享旅行经验
- [ ] 集成天气预报服务
- [ ] 支持多语言界面

## 📞 技术支持

如果在使用过程中遇到问题，可以：
1. 查看应用内的错误提示信息
2. 检查控制台日志输出
3. 参考本文档的常见问题部分
4. 联系开发团队获取支持

---

*最后更新: 2024年7月28日*
